import React, { useState, useEffect, PureComponent } from "react";
import styled from "styled-components";
import { ResponsiveContainer, Tooltip, Legend } from "recharts";
import { LineChart, Line, XAxis, YAxis, CartesianGrid } from "recharts";
import axios, { baseUrl } from "../../../../../utils/axios";
import { Spin } from "antd";
import { CustomizedLabel } from "../../../../../utils/helpers";

function InventoryGrowth(props) {
  const [data, setData] = useState([]);
  const [dataKeys, setDataKeys] = useState([]);

  // {
  //   CDN: 568,
  //   "EDN-NET": 2135,
  //   "EDN-SYS": 69,
  //   "SOC-NET": 186,
  //   "SOC-SYS": 411,
  //   POS: 0,
  //   REBD: 0,
  //   SOC: 307,
  //   date: "30-03-2022",
  // },
  // {
  //   CDN: 568,
  //   "EDN-NET": 2135,
  //   "EDN-SYS": 69,
  //   "SOC-NET": 186,
  //   "SOC-SYS": 411,
  //   POS: 0,
  //   REBD: 0,
  //   SOC: 307,
  //   date: "30-04-2022",
  // },

  useEffect(() => {
    const apis = async () => {
      const res = await axios.get(
        baseUrl + "/getSocvulnerabilityInventoryGrowth"
      );
      setData(res?.data);
      if (res?.data?.length > 0) {
        let dks = Object.keys(res?.data[0]);
        dks = dks.filter((e) => e !== "date");
        setDataKeys(dks);
      }
    };
    apis();
  }, []);

  const getBg = () => {
    const randomColor = Math.floor(Math.random() * 16777215).toString(16);
    return "#" + randomColor;
  };

  return (
    <div>
      <StyledCard
        style={{
          color: "white",
          fontSize: "18px",
          backgroundColor: "#009bdb",
          borderBottomRightRadius: "0",
          borderBottomLeftRadius: "0",
          paddingTop: "6px",
          // opacity: "0.8",
          paddingBottom: "8px",
          fontWeight: "bold",
          // borderColor: "3px solid brown",
        }}
      >
        SOC Overall Status Line Graph
      </StyledCard>
      <StyledCard
        style={{
          // backgroundColor,
          height: "55vh",
          borderTopRightRadius: "0",
          borderTopLeftRadius: "0",
          paddingTop: "18px",
        }}
      >
        {data ? (
          <ResponsiveContainer width="100%" height="100%">
            <LineChart
              width={730}
              height={250}
              data={data}
              margin={{ top: 5, right: 30, left: 0, bottom: 5 }}
            >
              <CartesianGrid strokeDasharray="3 3" />
              <XAxis
                dataKey="date"
                // axisLine={false}
                // tickLine={false}
                // tick={{ fill: "black" }}
              />
              <YAxis />
              <Tooltip />
              <Legend />
              {data?.length > 0
                ? dataKeys.map((element, index) => {
                    return (
                      <Line
                        type="monotone"
                        dataKey={element}
                        stroke={getBg()}
                        dot={false}
                        strokeWidth={3}
                        label={<CustomizedLabel />}
                      />
                    );
                  })
                : null}
            </LineChart>
          </ResponsiveContainer>
        ) : (
          <div
            style={{
              textAlign: "center",
              // border: "1px solid black",
              height: "100%",
              paddingTop: "12%",
            }}
          >
            <Spin tip="Loading Line Chart..." spinning={true} />
          </div>
        )}
      </StyledCard>
    </div>
  );
}

export default InventoryGrowth;

const StyledCard = styled.div`
  /* margin-top: -10px; */
  /* margin-bottom: 10px; */
  height: 100%;
  /* text-align: center; */
  background-color: white;
  border-radius: 10px;
  padding: 0px 20px 20px 20px;
  box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;
`;
